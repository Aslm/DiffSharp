<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- 
      The Reverse-on-Forward AD
 parameters will be replaced with the 
      document title extracted from the <h1> element or
      file name, if there is no <h1> heading
    -->
    <title>Reverse-on-Forward AD
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Atılım Güneş Baydin; Barak A. Pearlmutter">
    <meta name="description" content="DiffSharp is an automatic differentiation (AD) library implemented in the F# language by Atılım Güneş Baydin and Barak A. Pearlmutter, mainly for research applications in machine learning, as part of their work at the Brain and Computation Lab, Hamilton Institute, National University of Ireland Maynooth.">

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    
    <link type="text/css" rel="stylesheet" href="misc/style.css" />
    <script src="misc/tips.js" type="text/javascript"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-48900508-3', 'auto');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
        </ul>
        <h3 class="muted">DiffSharp</h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          <h1>Reverse-on-Forward AD</h1>

<p>The library provides a reverse-on-forward AD implementation, which is a mixed method where a forward AD pass is followed by a reverse AD pass. This gives an efficient way of computing Hessians and <a href="http://en.wikipedia.org/wiki/Hessian_automatic_differentiation">Hessian-vector products</a>.</p>

<p>For a complete list of the available differentiation operations, please refer to <a href="api-overview.html">API Overview</a> and <a href="reference/index.html">API Reference</a>.</p>

<h2>DiffSharp.AD.ForwardReverse</h2>

<p>This is a reverse-on-forward AD module, used with the <strong>DualAdj</strong> numeric type.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">DiffSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">AD</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">ForwardReverse</span>

<span class="c">// f: DualAdj[] -&gt; DualAdj</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">f</span> (<span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">DualAdj</span>[]) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="i">sin</span> (<span onmouseout="hideTip(event, 'fs5', 8)" onmouseover="showTip(event, 'fs5', 8)" class="i">x</span><span class="o">.</span>[<span class="n">0</span>] <span class="o">*</span> <span onmouseout="hideTip(event, 'fs5', 9)" onmouseover="showTip(event, 'fs5', 9)" class="i">x</span><span class="o">.</span>[<span class="n">1</span>])

<span class="c">// Gradient of f at (2, 3)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="i">gf</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="i">grad</span> <span onmouseout="hideTip(event, 'fs4', 12)" onmouseover="showTip(event, 'fs4', 12)" class="i">f</span> [|<span class="n">2.</span>; <span class="n">3.</span>|]

<span class="c">// Hessian of f at (2, 3)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 13)" onmouseover="showTip(event, 'fs10', 13)" class="i">hf</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs11', 14)" onmouseover="showTip(event, 'fs11', 14)" class="i">hessian</span> <span onmouseout="hideTip(event, 'fs4', 15)" onmouseover="showTip(event, 'fs4', 15)" class="i">f</span> [|<span class="n">2.</span>; <span class="n">3.</span>|]

<span class="c">// Product of the Hessian of f at (2, 3) with the vector (1.2, 2.5)</span>
<span class="c">// Computed in a matrix-free way and significantly faster </span>
<span class="c">// than computing the full Hessian and multiplying by the vector</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 16)" onmouseover="showTip(event, 'fs12', 16)" class="i">hfv</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 17)" onmouseover="showTip(event, 'fs13', 17)" class="i">hessianv</span> <span onmouseout="hideTip(event, 'fs4', 18)" onmouseover="showTip(event, 'fs4', 18)" class="i">f</span> [|<span class="n">2.</span>; <span class="n">3.</span>|] [|<span class="n">1.2</span>; <span class="n">2.5</span>|]

<span class="c">// Original value, gradient, and Hessian of f at (2, 3)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="i">oof</span>, <span onmouseout="hideTip(event, 'fs15', 20)" onmouseover="showTip(event, 'fs15', 20)" class="i">ggf</span>, <span onmouseout="hideTip(event, 'fs16', 21)" onmouseover="showTip(event, 'fs16', 21)" class="i">hhf</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs17', 22)" onmouseover="showTip(event, 'fs17', 22)" class="i">gradhessian&#39;</span> <span onmouseout="hideTip(event, 'fs4', 23)" onmouseover="showTip(event, 'fs4', 23)" class="i">f</span> [|<span class="n">2.</span>; <span class="n">3.</span>|]</pre>
</td>
</tr>
</table>

          <div class="tip" id="fs1">namespace DiffSharp</div>
<div class="tip" id="fs2">namespace DiffSharp.AD</div>
<div class="tip" id="fs3">module ForwardReverse<br /><br />from DiffSharp.AD</div>
<div class="tip" id="fs4">val f : x:DualAdj [] -&gt; DualAdj<br /><br />Full name: Gettingstarted-forwardreversead.f</div>
<div class="tip" id="fs5">val x : DualAdj []</div>
<div class="tip" id="fs6">Multiple items<br />union case DualAdj.DualAdj: DiffSharp.AD.Reverse.Adj * DiffSharp.AD.Reverse.Adj -&gt; DualAdj<br /><br />--------------------<br />type DualAdj =<br />&#160;&#160;| DualAdj of Adj * Adj<br />&#160;&#160;interface IComparable<br />&#160;&#160;override Equals : other:obj -&gt; bool<br />&#160;&#160;override GetHashCode : unit -&gt; int<br />&#160;&#160;override ToString : unit -&gt; string<br />&#160;&#160;member A : float with set<br />&#160;&#160;member TA : float with set<br />&#160;&#160;static member Abs : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Acos : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Asin : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Atan : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Atan2 : a:int * b:DualAdj -&gt; DualAdj<br />&#160;&#160;static member Atan2 : a:DualAdj * b:int -&gt; DualAdj<br />&#160;&#160;static member Atan2 : a:float * DualAdj -&gt; DualAdj<br />&#160;&#160;static member Atan2 : DualAdj * b:float -&gt; DualAdj<br />&#160;&#160;static member Atan2 : DualAdj * DualAdj -&gt; DualAdj<br />&#160;&#160;static member Ceiling : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Cos : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Cosh : DualAdj -&gt; DualAdj<br />&#160;&#160;static member DivideByInt : DualAdj * i:int -&gt; DualAdj<br />&#160;&#160;static member Exp : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Floor : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Log : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Log10 : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Pow : a:int * b:DualAdj -&gt; DualAdj<br />&#160;&#160;static member Pow : a:DualAdj * b:int -&gt; DualAdj<br />&#160;&#160;static member Pow : a:float * DualAdj -&gt; DualAdj<br />&#160;&#160;static member Pow : DualAdj * b:float -&gt; DualAdj<br />&#160;&#160;static member Pow : DualAdj * DualAdj -&gt; DualAdj<br />&#160;&#160;static member Round : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Sin : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Sinh : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Sqrt : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Tan : DualAdj -&gt; DualAdj<br />&#160;&#160;static member Tanh : DualAdj -&gt; DualAdj<br />&#160;&#160;static member One : DualAdj<br />&#160;&#160;static member Zero : DualAdj<br />&#160;&#160;static member ( + ) : a:int * b:DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( + ) : a:DualAdj * b:int -&gt; DualAdj<br />&#160;&#160;static member ( + ) : a:float * DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( + ) : DualAdj * b:float -&gt; DualAdj<br />&#160;&#160;static member ( + ) : DualAdj * DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( / ) : a:int * b:DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( / ) : a:DualAdj * b:int -&gt; DualAdj<br />&#160;&#160;static member ( / ) : a:float * DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( / ) : DualAdj * b:float -&gt; DualAdj<br />&#160;&#160;static member ( / ) : DualAdj * DualAdj -&gt; DualAdj<br />&#160;&#160;static member op_Explicit : DualAdj -&gt; float<br />&#160;&#160;static member op_Explicit : p:Adj -&gt; DualAdj<br />&#160;&#160;static member ( * ) : a:int * b:DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( * ) : a:DualAdj * b:int -&gt; DualAdj<br />&#160;&#160;static member ( * ) : a:float * DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( * ) : DualAdj * b:float -&gt; DualAdj<br />&#160;&#160;static member ( * ) : DualAdj * DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( - ) : a:int * b:DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( - ) : a:DualAdj * b:int -&gt; DualAdj<br />&#160;&#160;static member ( - ) : a:float * DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( - ) : DualAdj * b:float -&gt; DualAdj<br />&#160;&#160;static member ( - ) : DualAdj * DualAdj -&gt; DualAdj<br />&#160;&#160;static member ( ~- ) : DualAdj -&gt; DualAdj<br /><br />Full name: DiffSharp.AD.ForwardReverse.DualAdj</div>
<div class="tip" id="fs7">val sin : value:&#39;T -&gt; &#39;T (requires member Sin)<br /><br />Full name: Microsoft.FSharp.Core.Operators.sin</div>
<div class="tip" id="fs8">val gf : float []<br /><br />Full name: Gettingstarted-forwardreversead.gf</div>
<div class="tip" id="fs9">val grad : f:(DualAdj [] -&gt; DualAdj) -&gt; x:float [] -&gt; float []<br /><br />Full name: DiffSharp.AD.ForwardReverse.ForwardReverseOps.grad</div>
<div class="tip" id="fs10">val hf : float [,]<br /><br />Full name: Gettingstarted-forwardreversead.hf</div>
<div class="tip" id="fs11">val hessian : f:(DualAdj [] -&gt; DualAdj) -&gt; x:float [] -&gt; float [,]<br /><br />Full name: DiffSharp.AD.ForwardReverse.ForwardReverseOps.hessian</div>
<div class="tip" id="fs12">val hfv : float []<br /><br />Full name: Gettingstarted-forwardreversead.hfv</div>
<div class="tip" id="fs13">val hessianv : f:(DualAdj [] -&gt; DualAdj) -&gt; x:float [] -&gt; v:float [] -&gt; float []<br /><br />Full name: DiffSharp.AD.ForwardReverse.ForwardReverseOps.hessianv</div>
<div class="tip" id="fs14">val oof : float<br /><br />Full name: Gettingstarted-forwardreversead.oof</div>
<div class="tip" id="fs15">val ggf : float []<br /><br />Full name: Gettingstarted-forwardreversead.ggf</div>
<div class="tip" id="fs16">val hhf : float [,]<br /><br />Full name: Gettingstarted-forwardreversead.hhf</div>
<div class="tip" id="fs17">val gradhessian&#39; : f:(DualAdj [] -&gt; DualAdj) -&gt; x:float [] -&gt; float * float [] * float [,]<br /><br />Full name: DiffSharp.AD.ForwardReverse.ForwardReverseOps.gradhessian&#39;</div>
          
        </div>
        <div class="span3">
          <a href="index.html"><img src="img/diffsharp-logo.png" style="width:140px;height:140px;margin:10px 0px 0px 20px;border-style:none;"/></a>

          <ul class="nav nav-list" id="menu">
            <li class="nav-header">DiffSharp</li>
            <li class="divider"></li>
            <li><a href="index.html">Home Page</a></li>
            <li><a href="https://www.nuget.org/packages/diffsharp">Get DiffSharp via NuGet</a></li>
            <li><a href="http://github.com/gbaydin/DiffSharp">GitHub Page</a></li>
            <li><a href="http://github.com/gbaydin/DiffSharp/releases">Release Notes</a></li>

            <li class="nav-header">Getting Started</li>
            <li class="divider"></li>
            <li><a href="gettingstarted-typeinference.html">Type Inference</a></li>
            <li><a href="api-overview.html">API Overview</a></li>
            <li><a href="gettingstarted-forwardad.html">Forward AD</a></li>
            <li><a href="gettingstarted-reversead.html">Reverse AD</a></li>
            <li><a href="gettingstarted-forwardreversead.html">Reverse-on-Forward AD</a></li>
            <li><a href="gettingstarted-numericaldifferentiation.html">Numerical Differentiation</a></li>
            <li><a href="gettingstarted-symbolicdifferentiation.html">Symbolic Differentiation</a></li>
            
            <li class="nav-header">Benchmarks</li>
            <li class="divider"></li>
            <li><a href="benchmarks.html">Benchmarks</a></li>
            
            <li class="nav-header">Reference</li>
            <li class="divider"></li>
            <li><a href="reference/index.html">API Reference</a></li>

            <li class="nav-header">Examples</li>
            <li class="divider"></li>

            <li class="nav-header">Machine Learning</li>
            <li><a href="examples-gradientdescent.html">Gradient Descent</a></li>
            <li><a href="examples-stochasticgradientdescent.html">Stochastic Gradient Descent</a></li>
            <li><a href="examples-newtonsmethod.html">Newton's Method</a></li>
            <li><a href="examples-neuralnetworks.html">Neural Networks</a></li>
            <li>Neural Turing Machines (to come)</li>
            <li>Probabilistic Programming<br>(to come)</li>

            <li class="nav-header">Dynamical Systems</li>
            <li>Stability Analysis (to come)</li>

            <li class="nav-header">Control</li>
            <li><a href="examples-kinematics.html">Kinematics</a></li>
            <li><a href="examples-inversekinematics.html">Inverse Kinematics</a></li>
            <li>Adaptive Control (to come)</li>

            <li class="nav-header">Physics</li>
            <li><a href="examples-helmholtzenergyfunction.html">Helmholtz Energy Function</a></li>

            <li class="nav-header">Math</li>
            <li><a href="examples-lhopitalsrule.html">l'Hôpital's Rule</a></li>

            <li class="nav-header">Makers</li>
            <li class="divider"></li>
            <li><a href="http://www.cs.nuim.ie/~gunes/">Atılım Güneş Baydin</a></li>
            <li><a href="http://www.bcl.hamilton.ie/~barak/">Barak A. Pearlmutter</a></li>
            <li><a href="http://www.bcl.hamilton.ie/">Brain and Computation Lab</a></li>
          </ul>
        </div>
      </div>
    </div>
    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=10059115; 
    var sc_invisible=1; 
    var sc_security="92275ee1"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/10059115/0/92275ee1/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->
  </body>
  </html>